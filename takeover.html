<script>
  const clientKey = "aw8cb3204x0a1g88";
  const redirectUri = encodeURIComponent("https://ads.tiktok.com/login");

  const url = `https://www.tiktok.com/v2/auth/authorize?client_key=${clientKey}&response_type=code&scope=user.info.basic,user.info.username&redirect_uri=${redirectUri}&state=your_custom_state`;

  const authWindow = window.open(url, "_blank");

  (function pollOpener() {
    if (!window.opener || window.opener.closed) return;
    
    try {
      const href = window.opener.location.href;
      
      if (href.includes('code=')) {
        const urlParams = new URL(href).searchParams;
        const authCode = urlParams.get('code');
        
        alert("Authorization Code: " + authCode);
        
        return;
      } else {
        setTimeout(pollOpener, 500);
      }
    } catch (e) {
      setTimeout(pollOpener, 500); 
    }
  })();
</script>
